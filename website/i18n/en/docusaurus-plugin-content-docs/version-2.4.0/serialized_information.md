---
id: ble_serialized_information
title: 'シリアライズ情報'
sidebar_label: Serialized information
original_id: ble_serialized_information
---

キューブから取得できる読み込み/通知情報をまとめて 1 つの情報として提供します。本機能は何らかの理由でシリアライズされた情報が必要となった場合に使用する機能です。他のすべての読み込み/通知情報が取得できる環境であれば、使用する必要はありません。

:::note

この機能は**デフォルトでは無効**になっています。[設定 - シリアライズ情報の通知設定](configuration.md#シリアライズ情報の通知設定)で有効化してはじめて利用可能になります。

:::

シリアライズ情報は以下の特性（characteristic）を使うことで取得できます。特性は[設定](configuration.md)と同じです。

| プロパティ          | 値                                                                                 |
| ------------------- | ---------------------------------------------------------------------------------- |
| Characteristic UUID | 10B201FF-5B3B-4571-9508-CF3EFCD7BBAE                                               |
| Properties          | [Write](#書き込み操作), [Read](#読み出し操作--通知), [Notify](#読み出し操作--通知) |
| Descriptor          | Configuration                                                                      |

## 書き込み操作

シリアライズ情報に使用する書き込み操作はありません。

## 読み出し操作 / 通知

この特性は BLE セントラルに情報を通知します。
通知される情報は読み出し操作でも取得できます。

:::note

特性は[設定](configuration.md)と共通です。これらの情報も取得されますので、利用の際には[設定 - 読み出し操作](configuration.md#読み出し操作)や[設定 - 通知](configuration.md#通知)も確認してください。

:::

### シリアライズ情報の取得

以下のデータが取得できます。

| データ位置 | タイプ | 内容             | 例                                                      |
| ---------- | ------ | ---------------- | ------------------------------------------------------- |
| 0          | UInt8  | 情報の種類       | **`0xf0`** シリアライズ情報の取得 |
| 1          | 19Byte | シリアライズ情報 | 省略                                                    |

#### 情報の種類

**`0xf0`** は「シリアライズ情報の取得」を表します。

特性が[設定](configuration.md)と共通なので、以下に記載されている情報も取得できます。この情報の種類の値を調べて、どの情報を取得したか判断してください。

- [設定 - 読み出し操作](configuration.md#読み出し操作)
- [設定 - 通知](configuration.md#通知)

#### シリアライズ情報

以下のビット位置およびビットサイズのデータが取得できます。

| ビット位置 | ビットサイズ | 内容                                                             |
| ---------- | ------------ | ---------------------------------------------------------------- |
| 0          | 4 ビット     | Reserved                                                         |
| 4          | 1 ビット     | 機能ボタンの状態                                                 |
| 5          | 2 ビット     | toio ID 検出状態                                                 |
| 7          | 1 ビット     | Position ID または Standard ID のキューブの角度（下位）          |
| 8          | 8 ビット     | Position ID または Standard ID のキューブの角度（上位）          |
| 16         | 8 ビット     | Position ID のキューブの中心の X 座標値（下位）                  |
| 24         | 6 ビット     | Position ID のキューブの中心の X 座標値（上位）                  |
| 30         | 2 ビット     | Position ID のキューブの中心の Y 座標値（下位）                  |
| 32         | 8 ビット     | Position ID のキューブの中心の Y 座標値（中位）                  |
| 40         | 4 ビット     | Position ID のキューブの中心の Y 座標値（上位）                  |
| 44         | 4 ビット     | Standard ID の値（下位）                                         |
| 48         | 8 ビット     | Standard ID の値（中下位）                                       |
| 56         | 8 ビット     | Standard ID の値（中上位）                                       |
| 64         | 8 ビット     | Standard ID の値（上位）                                         |
| 72         | 8 ビット     | モーター ID 1（左）の速度                                        |
| 80         | 8 ビット     | モーター ID 2（右）の速度                                        |
| 88         | 5 ビット     | 目標指定付きモーター制御または複数目標指定付きモーター制御の応答 |
| 93         | 3 ビット     | モーション検出情報の姿勢検出                                     |
| 96         | 7 ビット     | バッテリー残量                                                   |
| 103        | 1 ビット     | モーション検出情報の水平検出                                     |
| 104        | 5 ビット     | モーション検出情報のシェイク検出                                 |
| 109        | 1 ビット     | モーション検出情報の衝突検出                                     |
| 110        | 1 ビット     | モーション検出情報のダブルタップ検出                             |
| 111        | 1 ビット     | Reserved                                                         |
| 112        | 8 ビット     | 姿勢角情報（オイラー角）の Roll（ロール/X 軸）の絶対値           |
| 120        | 8 ビット     | 姿勢角情報（オイラー角）の Pitch（ピッチ/Y 軸）の絶対値          |
| 128        | 8 ビット     | 姿勢角情報（オイラー角）の Yaw（ヨー/Z 軸）の絶対値              |
| 136        | 1 ビット     | 姿勢角情報（オイラー角）の Roll（ロール/X 軸）の符号             |
| 137        | 1 ビット     | 姿勢角情報（オイラー角）の Pitch（ピッチ/Y 軸）の符号            |
| 138        | 1 ビット     | 姿勢角情報（オイラー角）の Yaw（ヨー/Z 軸）の符号                |
| 139        | 2 ビット     | Reserved                                                         |
| 141        | 3 ビット     | 磁気センサーの磁石の状態                                         |
| 144        | 8 ビット     | 磁気センサーの磁力の強度                                         |

##### 機能ボタンの状態

[ボタン](button.md)で取得できる[機能ボタン](button.md#ボタンの-id)の[状態](button.md#ボタンの状態)を表します。

| 値    | 機能ボタンの状態 |
| ----- | ---------------- |
| `0b0` | 押されていない   |
| `0b1` | 押されている     |

##### toio ID 検出状態

[読み取りセンサー](id.md)で取得できる現在の toio ID の検出状態を表します。

| 値     | toio ID 検出状態         |
| ------ | ------------------------ |
| `0b01` | Standard ID の読み取り中 |
| `0b10` | Position ID の読み取り中 |
| `0b11` | 読み取り中でない         |

##### Position ID または Standard ID のキューブの角度

[読み取りセンサー](id.md)で取得できる[Position ID のキューブの角度](id.md#角度)または[Standard ID のキューブの角度](id.md#キューブの角度)を表します。どちらか最後に取得された角度が反映されます。

##### Position ID のキューブの中心の X 座標値

[読み取りセンサー](id.md)で取得できる[Position ID のキューブの中心の X 座標値](id.md#座標x-座標y-座標)を表します。
値の最大値が`0x3fff`までで、それ以上の値の場合は切り捨てられます。

##### Position ID のキューブの中心の Y 座標値

[読み取りセンサー](id.md)で取得できる[Position ID のキューブの中心の Y 座標値](id.md#座標x-座標y-座標)を表します。
値の最大値が`0x3fff`までで、それ以上の値の場合は切り捨てられます。

##### Standard ID の値

[読み取りセンサー](id.md)で取得できる[Standard ID の値](id.md#standard-id-の値)を表します。
値の最大値が`0xfffffff`までで、それ以上の値の場合は切り捨てられます。

##### モーター ID 1（左）の速度

[モーター](motor.md)で取得できる[モーター ID 1（左）の速度](motor.md#速度)を表します。
[設定 - モーターの速度情報の取得の設定](configuration.md#モーターの速度情報の取得の設定)が無効の場合は常に`0x00`となります。

##### モーター ID 2（右）の速度

[モーター](motor.md)で取得できる[モーター ID 2（右）の速度](motor.md#速度)を表します。
[設定 - モーターの速度情報の取得の設定](configuration.md#モーターの速度情報の取得の設定)が無効の場合は常に`0x00`となります。

##### 目標指定付きモーター制御または複数目標指定付きモーター制御の応答

[モーター](motor.md)で取得できる[目標指定付きモーター制御の応答内容](motor.md#応答内容)または[複数目標指定付きモーター制御の応答内容](motor.md#応答内容-1)を表します。
最後に実行した[目標指定付きモーター制御](motor.md#目標指定付きモーター制御)もしくは[複数目標指定付きモーター制御](motor.md#複数目標指定付きモーター制御)の応答結果を反映し、制御の実行中は`0x1f`の状態になります。

| 値         | 目標指定付きモーター制御または複数目標指定付きモーター制御の応答             |
| ---------- | ---------------------------------------------------------------------------- |
| `0x1f`     | 目標指定付きモーター制御または複数目標指定付きモーター制御を実行中           |
| `0x1f`以外 | 目標指定付きモーター制御の応答または複数目標指定付きモーター制御の応答と同じ |

##### モーション検出情報の姿勢検出

[モーション検出](sensor.md)で取得できる[姿勢検出](sensor.md#姿勢検出)を表します。

##### バッテリー残量

[バッテリー](battery.md)で取得できる[バッテリー残量](battery.md#バッテリー残量)を表します。

##### モーション検出情報の水平検出

[モーション検出](sensor.md)で取得できる[水平検出](sensor.md#水平検出)を表します。

##### モーション検出情報のシェイク検出

[モーション検出](sensor.md)で取得できる[シェイク検出](sensor.md#シェイク検出)を表します。

##### モーション検出情報の衝突検出

[モーション検出](sensor.md)で取得できる[衝突検出](sensor.md#衝突検出)を表します。

##### モーション検出情報のダブルタップ検出

[モーション検出](sensor.md)で取得できる[ダブルタップ検出](sensor.md#ダブルタップ検出)を表します。

##### 姿勢角情報（オイラー角）の Roll（ロール/X 軸）の絶対値

[姿勢角検出](high_precision_tilt_sensor.md)で取得できる[姿勢角情報（オイラー角）の Roll（ロール/X 軸）](high_precision_tilt_sensor.md#角度)の絶対値を表します。符号の情報は[姿勢角情報（オイラー角）の Roll（ロール/X 軸）の符号](#姿勢角情報オイラー角の-rollロールx-軸の符号)を参照してください。

##### 姿勢角情報（オイラー角）の Pitch（ピッチ/Y 軸）の絶対値

[姿勢角検出](high_precision_tilt_sensor.md)で取得できる[姿勢角情報（オイラー角）の Pitch（ピッチ/Y 軸）](high_precision_tilt_sensor.md#角度)の絶対値を表します。符号の情報は[姿勢角情報（オイラー角）の Pitch（ピッチ/Y 軸）の符号](#姿勢角情報オイラー角の-pitchピッチy-軸の符号)を参照してください。

##### 姿勢角情報（オイラー角）の Yaw（ヨー/Z 軸）の絶対値

[姿勢角検出](high_precision_tilt_sensor.md)で取得できる[姿勢角情報（オイラー角）の Yaw（ヨー/Z 軸）](high_precision_tilt_sensor.md#角度)の絶対値を表します。符号の情報は[姿勢角情報（オイラー角）の Yaw（ヨー/Z 軸）の符号](#姿勢角情報オイラー角の-yawヨーz-軸の符号)を参照してください。

##### 姿勢角情報（オイラー角）の Roll（ロール/X 軸）の符号

[姿勢角検出](high_precision_tilt_sensor.md)で取得できる[姿勢角情報（オイラー角）の Roll（ロール/X 軸）](high_precision_tilt_sensor.md#角度)の符号を表します。絶対値の情報は[姿勢角情報（オイラー角）の Roll（ロール/X 軸）の絶対値](#姿勢角情報オイラー角の-rollロールx-軸の絶対値)を参照してください。

##### 姿勢角情報（オイラー角）の Pitch（ピッチ/Y 軸）の符号

[姿勢角検出](high_precision_tilt_sensor.md)で取得できる[姿勢角情報（オイラー角）の Pitch（ピッチ/Y 軸）](high_precision_tilt_sensor.md#角度)の符号を表します。絶対値の情報は[姿勢角情報（オイラー角）の Pitch（ピッチ/Y 軸）の絶対値](#姿勢角情報オイラー角の-pitchピッチy-軸の絶対値)を参照してください。

##### 姿勢角情報（オイラー角）の Yaw（ヨー/Z 軸）の符号

[姿勢角検出](high_precision_tilt_sensor.md)で取得できる[姿勢角情報（オイラー角）の Yaw（ヨー/Z 軸）](high_precision_tilt_sensor.md#角度)の符号を表します。絶対値の情報は[姿勢角情報（オイラー角）の Yaw（ヨー/Z 軸）の絶対値](#姿勢角情報オイラー角の-yawヨーz-軸の絶対値)を参照してください。

##### 磁気センサーの磁石の状態

[磁気センサー](magnetic_sensor.md)で取得できる[磁石の状態](magnetic_sensor.md#磁石の状態)を表します。

##### 磁気センサーの磁力の強度

[磁気センサー](magnetic_sensor.md)で取得できる[磁石の強度](magnetic_sensor.md#磁力の強度)を表します。
なおシリアライズ情報では[磁石の方向](magnetic_sensor.md#磁力の方向)は取得できません。
