"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[5088],{15680:(e,t,n)=>{n.d(t,{xA:()=>p,yg:()=>c});var a=n(96540);function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,a)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function o(e,t){if(null==e)return{};var n,a,r=function(e,t){if(null==e)return{};var n,a,r={},i=Object.keys(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||(r[n]=e[n]);return r}(e,t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);for(a=0;a<i.length;a++)n=i[a],t.indexOf(n)>=0||Object.prototype.propertyIsEnumerable.call(e,n)&&(r[n]=e[n])}return r}var g=a.createContext({}),s=function(e){var t=a.useContext(g),n=t;return e&&(n="function"==typeof e?e(t):l(l({},t),e)),n},p=function(e){var t=s(e.components);return a.createElement(g.Provider,{value:t},e.children)},y="mdxType",d={inlineCode:"code",wrapper:function(e){var t=e.children;return a.createElement(a.Fragment,{},t)}},u=a.forwardRef((function(e,t){var n=e.components,r=e.mdxType,i=e.originalType,g=e.parentName,p=o(e,["components","mdxType","originalType","parentName"]),y=s(n),u=r,c=y["".concat(g,".").concat(u)]||y[u]||d[u]||i;return n?a.createElement(c,l(l({ref:t},p),{},{components:n})):a.createElement(c,l({ref:t},p))}));function c(e,t){var n=arguments,r=t&&t.mdxType;if("string"==typeof e||r){var i=n.length,l=new Array(i);l[0]=u;var o={};for(var g in t)hasOwnProperty.call(t,g)&&(o[g]=t[g]);o.originalType=e,o[y]="string"==typeof e?e:r,l[1]=o;for(var s=2;s<i;s++)l[s]=n[s];return a.createElement.apply(null,l)}return a.createElement.apply(null,n)}u.displayName="MDXCreateElement"},75804:(e,t,n)=>{n.r(t),n.d(t,{assets:()=>p,contentTitle:()=>g,default:()=>c,frontMatter:()=>o,metadata:()=>s,toc:()=>y});var a=n(58168),r=n(98587),i=(n(96540),n(15680)),l=["components"],o={id:"ble_high_precision_tilt_sensor",title:"Posture Angle detection",sidebar_label:"\ud83d\udd04 Posture Angle detection"},g=void 0,s={unversionedId:"ble_high_precision_tilt_sensor",id:"version-2.4.0/ble_high_precision_tilt_sensor",title:"Posture Angle detection",description:".",source:"@site/i18n/en/docusaurus-plugin-content-docs/version-2.4.0/high_precision_tilt_sensor.md",sourceDirName:".",slug:"/ble_high_precision_tilt_sensor",permalink:"/toio-spec/en/docs/ble_high_precision_tilt_sensor",draft:!1,tags:[],version:"2.4.0",frontMatter:{id:"ble_high_precision_tilt_sensor",title:"Posture Angle detection",sidebar_label:"\ud83d\udd04 Posture Angle detection"},sidebar:"docs",previous:{title:"motion detection",permalink:"/toio-spec/en/docs/ble_sensor"},next:{title:"Magnetic sensor",permalink:"/toio-spec/en/docs/ble_magnetic_sensor"}},p={},y=[{value:'Write operations <span class="update"/>',id:"write-operations-",level:2},{value:"Requesting posture angle detection",id:"requesting-posture-angle-detection",level:3},{value:'Read operations / Notifications <span class="update"/>',id:"read-operations--notifications-",level:2},{value:"Obtaining posture angle information (notifications in Euler angles)",id:"obtaining-posture-angle-information-notifications-in-euler-angles",level:3},{value:"Angles",id:"angles",level:4},{value:"Errors",id:"errors",level:4},{value:'Obtaining posture angle information (notifications in quaternions) <span class="new"/>',id:"obtaining-posture-angle-information-notifications-in-quaternions-",level:3},{value:"Value range",id:"value-range",level:4},{value:'Obtaining posture angle information (notifications in high precision Euler angles) <span class="new"/>',id:"obtaining-posture-angle-information-notifications-in-high-precision-euler-angles-",level:3},{value:"Angles",id:"angles-1",level:4},{value:"Errors",id:"errors-1",level:4}],d={toc:y},u="wrapper";function c(e){var t=e.components,o=(0,r.A)(e,l);return(0,i.yg)(u,(0,a.A)({},d,o,{components:t,mdxType:"MDXLayout"}),(0,i.yg)("p",null,"."),(0,i.yg)("p",null,(0,i.yg)("img",{alt:"Cube coordinate system",src:n(53293).A,width:"555",height:"209"})),(0,i.yg)("p",null,"Using a posture estimation algorithm, the posture angle (estimated value) is calculated based on the output from the cube's motion sensor (6-axis detection system).\nBecause this posture angle is not a raw value from the motion sensor but a value calculated in the cube with the acceleration and angular velocity, it always contains a certain amount of error or drift."),(0,i.yg)("admonition",{type:"note"},(0,i.yg)("p",{parentName:"admonition"},"This feature is ",(0,i.yg)("strong",{parentName:"p"},"disabled")," by default. It becomes operational only once enabled in ",(0,i.yg)("a",{parentName:"p",href:"/toio-spec/en/docs/ble_configuration#posture-angle-detection-settings"},"Configuration - Posture angle detection settings"),".")),(0,i.yg)("p",null,"Posture angle detection can be obtained using the following characteristics. These characteristics are the same for ",(0,i.yg)("a",{parentName:"p",href:"/toio-spec/en/docs/ble_sensor"},"Motion Detection")," and ",(0,i.yg)("a",{parentName:"p",href:"/toio-spec/en/docs/ble_magnetic_sensor"},"Magnetic Sensor"),"."),(0,i.yg)("table",null,(0,i.yg)("thead",{parentName:"table"},(0,i.yg)("tr",{parentName:"thead"},(0,i.yg)("th",{parentName:"tr",align:null},"Property"),(0,i.yg)("th",{parentName:"tr",align:null},"Value"))),(0,i.yg)("tbody",{parentName:"table"},(0,i.yg)("tr",{parentName:"tbody"},(0,i.yg)("td",{parentName:"tr",align:null},"Characteristic UUID"),(0,i.yg)("td",{parentName:"tr",align:null},"10B20106-5B3B-4571-9508-CF3EFCD7BBAE")),(0,i.yg)("tr",{parentName:"tbody"},(0,i.yg)("td",{parentName:"tr",align:null},"Properties"),(0,i.yg)("td",{parentName:"tr",align:null},(0,i.yg)("a",{parentName:"td",href:"#write-operations"},"Write"),", ",(0,i.yg)("a",{parentName:"td",href:"#read-operations--notifications"},"Read"),", ",(0,i.yg)("a",{parentName:"td",href:"#read-operations--notifications"},"Notify"))),(0,i.yg)("tr",{parentName:"tbody"},(0,i.yg)("td",{parentName:"tr",align:null},"Descriptor"),(0,i.yg)("td",{parentName:"tr",align:null},"Sensor Information")))),(0,i.yg)("h2",{id:"write-operations-"},"Write operations ",(0,i.yg)("span",{class:"update"})),(0,i.yg)("h3",{id:"requesting-posture-angle-detection"},"Requesting posture angle detection"),(0,i.yg)("p",null,"Posture angle information can be requested by writing the following data. Once the cube receives a request, it makes a notification on the posture angle once."),(0,i.yg)("table",null,(0,i.yg)("thead",{parentName:"table"},(0,i.yg)("tr",{parentName:"thead"},(0,i.yg)("th",{parentName:"tr",align:null},"Data location"),(0,i.yg)("th",{parentName:"tr",align:null},"Type"),(0,i.yg)("th",{parentName:"tr",align:null},"Content"),(0,i.yg)("th",{parentName:"tr",align:null},"Example"))),(0,i.yg)("tbody",{parentName:"table"},(0,i.yg)("tr",{parentName:"tbody"},(0,i.yg)("td",{parentName:"tr",align:null},"0"),(0,i.yg)("td",{parentName:"tr",align:null},"UInt8"),(0,i.yg)("td",{parentName:"tr",align:null},"Information type"),(0,i.yg)("td",{parentName:"tr",align:null},(0,i.yg)("span",{class:"fixed"},(0,i.yg)("inlineCode",{parentName:"td"},"0x83"))," (Request for posture angle detection)")),(0,i.yg)("tr",{parentName:"tbody"},(0,i.yg)("td",{parentName:"tr",align:null},"1"),(0,i.yg)("td",{parentName:"tr",align:null},"UInt8"),(0,i.yg)("td",{parentName:"tr",align:null},"Notification type"),(0,i.yg)("td",{parentName:"tr",align:null},(0,i.yg)("span",{class:"fixed"},(0,i.yg)("inlineCode",{parentName:"td"},"0x01"))," (Notifications in Euler angles)")))),(0,i.yg)("p",null,"The types of notifications are as follows"),(0,i.yg)("table",null,(0,i.yg)("thead",{parentName:"table"},(0,i.yg)("tr",{parentName:"thead"},(0,i.yg)("th",{parentName:"tr",align:null},"Type of notification content"),(0,i.yg)("th",{parentName:"tr",align:null},"Definition"))),(0,i.yg)("tbody",{parentName:"table"},(0,i.yg)("tr",{parentName:"tbody"},(0,i.yg)("td",{parentName:"tr",align:null},(0,i.yg)("inlineCode",{parentName:"td"},"0x01")),(0,i.yg)("td",{parentName:"tr",align:null},"Notifications in Euler angles")),(0,i.yg)("tr",{parentName:"tbody"},(0,i.yg)("td",{parentName:"tr",align:null},(0,i.yg)("inlineCode",{parentName:"td"},"0x02")," ",(0,i.yg)("span",{class:"new"})),(0,i.yg)("td",{parentName:"tr",align:null},"Notifications in quaternions")),(0,i.yg)("tr",{parentName:"tbody"},(0,i.yg)("td",{parentName:"tr",align:null},(0,i.yg)("inlineCode",{parentName:"td"},"0x03")," ",(0,i.yg)("span",{class:"new"})),(0,i.yg)("td",{parentName:"tr",align:null},"Notifications in high precision Euler angles")))),(0,i.yg)("h2",{id:"read-operations--notifications-"},"Read operations / Notifications ",(0,i.yg)("span",{class:"update"})),(0,i.yg)("p",null,"When the posture angle of the cube changes, this characteristic notifies the BLE central of this information.\nThe notified information can also be obtained through read operations."),(0,i.yg)("admonition",{type:"note"},(0,i.yg)("p",{parentName:"admonition"},"This characteristic is the same for ",(0,i.yg)("a",{parentName:"p",href:"/toio-spec/en/docs/ble_sensor"},"Motion detection")," and ",(0,i.yg)("a",{parentName:"p",href:"/toio-spec/en/docs/ble_magnetic_sensor"},"Magnetic sensor"),". Since this information is also obtained, please also see ",(0,i.yg)("a",{parentName:"p",href:"/toio-spec/en/docs/ble_sensor#read-operations--notifications"},"Motion detection - Read operations / Notifications")," and ",(0,i.yg)("a",{parentName:"p",href:"/toio-spec/en/docs/ble_magnetic_sensor#read-operations--notifications"},"Magnetic sensor - Read operations / Notifications")," when using this characteristic.")),(0,i.yg)("h3",{id:"obtaining-posture-angle-information-notifications-in-euler-angles"},"Obtaining posture angle information (notifications in Euler angles)"),(0,i.yg)("p",null,"The following data can be obtained when the type of notification content is set to Euler angle notifications."),(0,i.yg)("table",null,(0,i.yg)("thead",{parentName:"table"},(0,i.yg)("tr",{parentName:"thead"},(0,i.yg)("th",{parentName:"tr",align:null},"Data location"),(0,i.yg)("th",{parentName:"tr",align:null},"Type"),(0,i.yg)("th",{parentName:"tr",align:null},"Content"),(0,i.yg)("th",{parentName:"tr",align:null},"Example"))),(0,i.yg)("tbody",{parentName:"table"},(0,i.yg)("tr",{parentName:"tbody"},(0,i.yg)("td",{parentName:"tr",align:null},"0"),(0,i.yg)("td",{parentName:"tr",align:null},"UInt8"),(0,i.yg)("td",{parentName:"tr",align:null},"Information type"),(0,i.yg)("td",{parentName:"tr",align:null},(0,i.yg)("span",{class:"fixed"},(0,i.yg)("inlineCode",{parentName:"td"},"0x03"))," (Posture angle detection)")),(0,i.yg)("tr",{parentName:"tbody"},(0,i.yg)("td",{parentName:"tr",align:null},"1"),(0,i.yg)("td",{parentName:"tr",align:null},"UInt8"),(0,i.yg)("td",{parentName:"tr",align:null},"Notification type"),(0,i.yg)("td",{parentName:"tr",align:null},(0,i.yg)("span",{class:"fixed"},(0,i.yg)("inlineCode",{parentName:"td"},"0x01"))," (Notifications in Euler angles)")),(0,i.yg)("tr",{parentName:"tbody"},(0,i.yg)("td",{parentName:"tr",align:null},"2"),(0,i.yg)("td",{parentName:"tr",align:null},"Int16"),(0,i.yg)("td",{parentName:"tr",align:null},"Roll (X axis)"),(0,i.yg)("td",{parentName:"tr",align:null},(0,i.yg)("inlineCode",{parentName:"td"},"0x00B4")," (180 degree)")),(0,i.yg)("tr",{parentName:"tbody"},(0,i.yg)("td",{parentName:"tr",align:null},"4"),(0,i.yg)("td",{parentName:"tr",align:null},"Int16"),(0,i.yg)("td",{parentName:"tr",align:null},"Pitch (Y axis)"),(0,i.yg)("td",{parentName:"tr",align:null},(0,i.yg)("inlineCode",{parentName:"td"},"0x0000")," (0 degree)")),(0,i.yg)("tr",{parentName:"tbody"},(0,i.yg)("td",{parentName:"tr",align:null},"6"),(0,i.yg)("td",{parentName:"tr",align:null},"Int16"),(0,i.yg)("td",{parentName:"tr",align:null},"Yaw (Z axis)"),(0,i.yg)("td",{parentName:"tr",align:null},(0,i.yg)("inlineCode",{parentName:"td"},"0xFF4E")," (-178 degree)")))),(0,i.yg)("h4",{id:"angles"},"Angles"),(0,i.yg)("p",null,"Euler angle format is integer."),(0,i.yg)("p",null,"The angle range is -179\xb0(0xFF4D) to 180\xb0(0x00B4) for roll and yaw, and -90\xb0(0xFFA6) to 90\xb0(0x005A) for pitch."),(0,i.yg)("p",null,"The rotation order is yaw (Z axis), pitch (Y axis), roll (X axis).\nThe roll angle and pitch angle are 0\xb0 when the cube is placed horizontally on a surface with the wheel side on the bottom. The yaw angle is 0\xb0 when the cube is facing the direction it faced when it was turned on."),(0,i.yg)("h4",{id:"errors"},"Errors"),(0,i.yg)("p",null,"Because rotation around the Z axis (yaw angle in Euler angles) cannot be corrected with acceleration sensor, errors will accumulate. The following is a concrete example of this effect."),(0,i.yg)("ul",null,(0,i.yg)("li",{parentName:"ul"},"The yaw angle shifts by about 1\xb0 every few seconds even though the cube is not moving."),(0,i.yg)("li",{parentName:"ul"},"The yaw angle shifts by several degrees when the cube rotates by one rotation with the Z axis as the central axis.")),(0,i.yg)("h3",{id:"obtaining-posture-angle-information-notifications-in-quaternions-"},"Obtaining posture angle information (notifications in quaternions) ",(0,i.yg)("span",{class:"new"})),(0,i.yg)("p",null,"When the notification content type is set to notifications in quaternions, the following data can be obtained."),(0,i.yg)("table",null,(0,i.yg)("thead",{parentName:"table"},(0,i.yg)("tr",{parentName:"thead"},(0,i.yg)("th",{parentName:"tr",align:null},"Data location"),(0,i.yg)("th",{parentName:"tr",align:null},"Type"),(0,i.yg)("th",{parentName:"tr",align:null},"Content"),(0,i.yg)("th",{parentName:"tr",align:null},"Example"))),(0,i.yg)("tbody",{parentName:"table"},(0,i.yg)("tr",{parentName:"tbody"},(0,i.yg)("td",{parentName:"tr",align:null},"0"),(0,i.yg)("td",{parentName:"tr",align:null},"UInt8"),(0,i.yg)("td",{parentName:"tr",align:null},"Information type"),(0,i.yg)("td",{parentName:"tr",align:null},(0,i.yg)("span",{class:"fixed"},(0,i.yg)("inlineCode",{parentName:"td"},"0x03"))," (Posture angle detection)")),(0,i.yg)("tr",{parentName:"tbody"},(0,i.yg)("td",{parentName:"tr",align:null},"1"),(0,i.yg)("td",{parentName:"tr",align:null},"UInt8"),(0,i.yg)("td",{parentName:"tr",align:null},"Notification type"),(0,i.yg)("td",{parentName:"tr",align:null},(0,i.yg)("span",{class:"fixed"},(0,i.yg)("inlineCode",{parentName:"td"},"0x02"))," (Notifications in quaternions)")),(0,i.yg)("tr",{parentName:"tbody"},(0,i.yg)("td",{parentName:"tr",align:null},"2"),(0,i.yg)("td",{parentName:"tr",align:null},"Float32"),(0,i.yg)("td",{parentName:"tr",align:null},"w"),(0,i.yg)("td",{parentName:"tr",align:null},(0,i.yg)("inlineCode",{parentName:"td"},"0x0000803F")," (1.0)")),(0,i.yg)("tr",{parentName:"tbody"},(0,i.yg)("td",{parentName:"tr",align:null},"4"),(0,i.yg)("td",{parentName:"tr",align:null},"Float32"),(0,i.yg)("td",{parentName:"tr",align:null},"x"),(0,i.yg)("td",{parentName:"tr",align:null},(0,i.yg)("inlineCode",{parentName:"td"},"0x00000000")," (0.0)")),(0,i.yg)("tr",{parentName:"tbody"},(0,i.yg)("td",{parentName:"tr",align:null},"6"),(0,i.yg)("td",{parentName:"tr",align:null},"Float32"),(0,i.yg)("td",{parentName:"tr",align:null},"y"),(0,i.yg)("td",{parentName:"tr",align:null},(0,i.yg)("inlineCode",{parentName:"td"},"0x00000000")," (0.0)")),(0,i.yg)("tr",{parentName:"tbody"},(0,i.yg)("td",{parentName:"tr",align:null},"8"),(0,i.yg)("td",{parentName:"tr",align:null},"Float32"),(0,i.yg)("td",{parentName:"tr",align:null},"z"),(0,i.yg)("td",{parentName:"tr",align:null},(0,i.yg)("inlineCode",{parentName:"td"},"0x00000000")," (0.0)")))),(0,i.yg)("h4",{id:"value-range"},"Value range"),(0,i.yg)("p",null,"The value range is -1.0 to 1.0."),(0,i.yg)("h3",{id:"obtaining-posture-angle-information-notifications-in-high-precision-euler-angles-"},"Obtaining posture angle information (notifications in high precision Euler angles) ",(0,i.yg)("span",{class:"new"})),(0,i.yg)("p",null,"The following data can be obtained when the type of notification content is set to high precision Euler angle notifications."),(0,i.yg)("table",null,(0,i.yg)("thead",{parentName:"table"},(0,i.yg)("tr",{parentName:"thead"},(0,i.yg)("th",{parentName:"tr",align:null},"Data location"),(0,i.yg)("th",{parentName:"tr",align:null},"Type"),(0,i.yg)("th",{parentName:"tr",align:null},"Content"),(0,i.yg)("th",{parentName:"tr",align:null},"Example"))),(0,i.yg)("tbody",{parentName:"table"},(0,i.yg)("tr",{parentName:"tbody"},(0,i.yg)("td",{parentName:"tr",align:null},"0"),(0,i.yg)("td",{parentName:"tr",align:null},"UInt8"),(0,i.yg)("td",{parentName:"tr",align:null},"Information type"),(0,i.yg)("td",{parentName:"tr",align:null},(0,i.yg)("span",{class:"fixed"},(0,i.yg)("inlineCode",{parentName:"td"},"0x03"))," (Posture angle detection)")),(0,i.yg)("tr",{parentName:"tbody"},(0,i.yg)("td",{parentName:"tr",align:null},"1"),(0,i.yg)("td",{parentName:"tr",align:null},"UInt8"),(0,i.yg)("td",{parentName:"tr",align:null},"Notification type"),(0,i.yg)("td",{parentName:"tr",align:null},(0,i.yg)("span",{class:"fixed"},(0,i.yg)("inlineCode",{parentName:"td"},"0x03"))," (Notifications in high precision Euler angles)")),(0,i.yg)("tr",{parentName:"tbody"},(0,i.yg)("td",{parentName:"tr",align:null},"2"),(0,i.yg)("td",{parentName:"tr",align:null},"Float32"),(0,i.yg)("td",{parentName:"tr",align:null},"Roll (X axis)"),(0,i.yg)("td",{parentName:"tr",align:null},(0,i.yg)("inlineCode",{parentName:"td"},"0x00003443")," (180.0 degree)")),(0,i.yg)("tr",{parentName:"tbody"},(0,i.yg)("td",{parentName:"tr",align:null},"4"),(0,i.yg)("td",{parentName:"tr",align:null},"Float32"),(0,i.yg)("td",{parentName:"tr",align:null},"Pitch (Y axis)"),(0,i.yg)("td",{parentName:"tr",align:null},(0,i.yg)("inlineCode",{parentName:"td"},"0x00000000")," (0.0 degree)")),(0,i.yg)("tr",{parentName:"tbody"},(0,i.yg)("td",{parentName:"tr",align:null},"6"),(0,i.yg)("td",{parentName:"tr",align:null},"Float32"),(0,i.yg)("td",{parentName:"tr",align:null},"Yaw (Z axis)"),(0,i.yg)("td",{parentName:"tr",align:null},(0,i.yg)("inlineCode",{parentName:"td"},"0x00000000")," (0.0 degree)")))),(0,i.yg)("h4",{id:"angles-1"},"Angles"),(0,i.yg)("p",null,"Euler angle format is float32."),(0,i.yg)("p",null,"The roll and yaw angle range is greater than -180 and less than or equal to 180 degree."),(0,i.yg)("p",null,"the pitch angle range is greater than -90 and less than or equal t0 90 degree."),(0,i.yg)("p",null,"The rotation order is yaw (Z axis), pitch (Y axis), roll (X axis).\nThe roll angle and pitch angle are 0\xb0 when the cube is placed horizontally on a surface with the wheel side on the bottom. The yaw angle is 0\xb0 when the cube is facing the direction it faced when it was turned on."),(0,i.yg)("h4",{id:"errors-1"},"Errors"),(0,i.yg)("p",null,"Because rotation around the Z axis (yaw angle in Euler angles) cannot be corrected with acceleration sensor, errors will accumulate. The following is a concrete example of this effect."),(0,i.yg)("ul",null,(0,i.yg)("li",{parentName:"ul"},"The yaw angle shifts by about 1\xb0 every few seconds even though the cube is not moving."),(0,i.yg)("li",{parentName:"ul"},"The yaw angle shifts by several degrees when the cube rotates by one rotation with the Z axis as the central axis.")))}c.isMDXComponent=!0},53293:(e,t,n)=>{n.d(t,{A:()=>a});const a=n.p+"assets/images/sensor_cube_axis-c811d07901943cf1d221286bf5c2bff4.svg"}}]);